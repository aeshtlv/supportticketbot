# ๐ซ Telegram Support Bot

Telegram ะฑะพั ั ัะธะบะตั-ัะธััะตะผะพะน ะดะปั ัะปัะถะฑั ะฟะพะดะดะตัะถะบะธ. ะะพัััะพะตะฝ ะฝะฐ FSM-ะฐััะธัะตะบัััะต ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ aiogram 3.x.

## ๐ ะะพะทะผะพะถะฝะพััะธ

### ะะปั ะฟะพะปัะทะพะฒะฐัะตะปะตะน:
- ๐ ะกะพะทะดะฐะฝะธะต ัะธะบะตัะพะฒ ั ัะตะผะพะน ะธ ะพะฟะธัะฐะฝะธะตะผ
- ๐ฌ ะะฑัะตะฝะธะต ั ะพะฟะตัะฐัะพัะพะผ ะฒะฝัััะธ ัะธะบะตัะฐ
- ๐ ะัะฟัะฐะฒะบะฐ ัะตะบััะฐ, ัะพัะพ ะธ ะดะพะบัะผะตะฝัะพะฒ
- ๐ ะัะพัะผะพัั ะธััะพัะธะธ ัะฒะพะธั ะพะฑัะฐัะตะฝะธะน

### ะะปั ะพะฟะตัะฐัะพัะพะฒ:
- ๐ฅ ะัะพัะผะพัั ัะฟะธัะบะฐ ะพัะบััััั ัะธะบะตัะพะฒ
- โ๏ธ ะัะฒะตัั ะฟะพะปัะทะพะฒะฐัะตะปัะผ
- ๐ ะะฐะบัััะธะต ัะธะบะตัะพะฒ
- โณ ะฃััะฐะฝะพะฒะบะฐ ััะฐัััะฐ "ะะถะธะดะฐะตะผ ะฟะพะปัะทะพะฒะฐัะตะปั"
- ๐ ะัะพัะผะพัั ะธััะพัะธะธ ัะพะพะฑัะตะฝะธะน

## ๐๏ธ ะััะธัะตะบัััะฐ FSM

### ะกะพััะพัะฝะธั ะฟะพะปัะทะพะฒะฐัะตะปั:
```
IDLE โ CREATE_TICKET_SUBJECT โ CREATE_TICKET_MESSAGE โ TICKET_CHAT
```

### ะกะพััะพัะฝะธั ะพะฟะตัะฐัะพัะฐ:
```
OP_IDLE โ OP_VIEW_TICKET โ OP_REPLY
```

### ะกัะฐัััั ัะธะบะตัะพะฒ:
| ะกัะฐััั | ะะฟะธัะฐะฝะธะต |
|--------|----------|
| `open` | ะัะบััั, ะพะฟะตัะฐัะพั ะฝะต ะฝะฐะทะฝะฐัะตะฝ |
| `in_progress` | ะะฟะตัะฐัะพั ะพัะฒะตัะฐะตั |
| `waiting_user` | ะะดัะผ ะพัะฒะตั ะบะปะธะตะฝัะฐ |
| `closed` | ะะฐะบััั |

## ๐ ะฃััะฐะฝะพะฒะบะฐ

### 1. ะะปะพะฝะธััะนัะต ัะตะฟะพะทะธัะพัะธะน
```bash
cd supportticketbot
```

### 2. ะกะพะทะดะฐะนัะต ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต
```bash
python -m venv venv
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate
```

### 3. ะฃััะฐะฝะพะฒะธัะต ะทะฐะฒะธัะธะผะพััะธ
```bash
pip install -r requirements.txt
```

### 4. ะะฐัััะพะนัะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

ะกะพะทะดะฐะนัะต ัะฐะนะป `.env` ะฒ ะบะพัะฝะต ะฟัะพะตะบัะฐ:
```env
BOT_TOKEN=your_telegram_bot_token_here
OPERATOR_IDS=123456789,987654321
```

- `BOT_TOKEN` โ ัะพะบะตะฝ ะฑะพัะฐ ะพั [@BotFather](https://t.me/BotFather)
- `OPERATOR_IDS` โ Telegram ID ะพะฟะตัะฐัะพัะพะฒ ัะตัะตะท ะทะฐะฟัััั

### 5. ะะฐะฟัััะธัะต ะฑะพัะฐ
```bash
python main.py
```

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
supportticketbot/
โโโ main.py                 # ะขะพัะบะฐ ะฒัะพะดะฐ
โโโ config.py               # ะะพะฝัะธะณััะฐัะธั
โโโ requirements.txt        # ะะฐะฒะธัะธะผะพััะธ
โ
โโโ database/
โ   โโโ __init__.py
โ   โโโ models.py           # ะะพะดะตะปะธ SQLAlchemy
โ   โโโ connection.py       # ะะพะดะบะปััะตะฝะธะต ะบ ะะ
โ
โโโ states/
โ   โโโ __init__.py
โ   โโโ user_states.py      # FSM ะฟะพะปัะทะพะฒะฐัะตะปั
โ   โโโ operator_states.py  # FSM ะพะฟะตัะฐัะพัะฐ
โ
โโโ handlers/
โ   โโโ __init__.py
โ   โโโ common_handlers.py  # /start, /help, /new, /tickets
โ   โโโ user_handlers.py    # ะะฑัะฐะฑะพััะธะบะธ ะฟะพะปัะทะพะฒะฐัะตะปั
โ   โโโ operator_handlers.py # ะะฑัะฐะฑะพััะธะบะธ ะพะฟะตัะฐัะพัะฐ
โ
โโโ keyboards/
โ   โโโ __init__.py
โ   โโโ user_kb.py          # ะะปะฐะฒะธะฐัััั ะฟะพะปัะทะพะฒะฐัะตะปั
โ   โโโ operator_kb.py      # ะะปะฐะฒะธะฐัััั ะพะฟะตัะฐัะพัะฐ
โ
โโโ services/
    โโโ __init__.py
    โโโ ticket_service.py   # ะะธะทะฝะตั-ะปะพะณะธะบะฐ ัะธะบะตัะพะฒ
```

## ๐ฏ ะะพะผะฐะฝะดั ะฑะพัะฐ

### ะะปั ะฒัะตั:
- `/start` โ ะะปะฐะฒะฝะพะต ะผะตะฝั
- `/help` โ ะกะฟัะฐะฒะบะฐ

### ะะปั ะฟะพะปัะทะพะฒะฐัะตะปะตะน:
- `/new` โ ะกะพะทะดะฐัั ะฝะพะฒัะน ัะธะบะตั
- `/tickets` โ ะะพะธ ะพะฑัะฐัะตะฝะธั

### ะะปั ะพะฟะตัะฐัะพัะพะฒ:
- `/tickets` โ ะกะฟะธัะพะบ ะพัะบััััั ัะธะบะตัะพะฒ

## โ๏ธ Edge Cases

### ะะพะปัะทะพะฒะฐัะตะปั ะฟะธัะตั ะฑะตะท ะฐะบัะธะฒะฝะพะณะพ ัะธะบะตัะฐ
ะะพั ะฟัะตะดะปะพะถะธั ัะพะทะดะฐัั ะฝะพะฒัะน ัะธะบะตั.

### ะะพะปัะทะพะฒะฐัะตะปั ัะพะทะดะฐัั ะฒัะพัะพะน ัะธะบะตั
ะะพั ัะฟัะพัะธั ะฟะพะดัะฒะตัะถะดะตะฝะธะต, ะตัะปะธ ัะถะต ะตััั ะพัะบััััะต ัะธะบะตัั.

### ะะฟะตัะฐัะพั ะฟะธัะตั ะฑะตะท ะฒัะฑัะฐะฝะฝะพะณะพ ัะธะบะตัะฐ
ะะพั ะฝะฐะฟะพะผะฝะธั ัะฝะฐัะฐะปะฐ ะฒัะฑัะฐัั ัะธะบะตั.

## ๐ง ะะฐัััะพะนะบะฐ

### ะะทะผะตะฝะตะฝะธะต ะปะธะผะธัะพะฒ
ะ `config.py`:
```python
MAX_SUBJECT_LENGTH = 255           # ะะฐะบั. ะดะปะธะฝะฐ ัะตะผั
MAX_OPEN_TICKETS_PER_USER = 5      # ะะฐะบั. ะพัะบััััั ัะธะบะตัะพะฒ
```

### ะัะฟะพะปัะทะพะฒะฐะฝะธะต Redis ะดะปั FSM
ะะปั ะฟัะพะดะฐะบัะตะฝะฐ ัะตะบะพะผะตะฝะดัะตััั ะธัะฟะพะปัะทะพะฒะฐัั Redis:

```python
# main.py
from aiogram.fsm.storage.redis import RedisStorage

storage = RedisStorage.from_url("redis://localhost:6379/0")
```

## ๐ ะะธัะตะฝะทะธั

MIT

